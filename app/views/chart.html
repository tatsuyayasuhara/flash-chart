<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Chart</title>
    <style>
        .input_txt{
            width: 100px;
        }
        body {
            font-family: "Open Sans", sans-serif;
            line-height: 1.25;
        }

        table {
            border-collapse: collapse;
            margin: 0 auto;
            padding: 0;
            width: 700px;
            box-shadow: 0 0 15px -6px #00000073;
        }
        table tr {
            background-color: #fff;
        }
        table tbody tr:hover{
            background-color: #fffae9;
        }
        table th,
        table td {
            padding: .35em 1em;
            border-bottom: 1px solid #eee;
        }
        table thead th {
            font-size: .85em;
            padding: 1em;
        }
        table thead tr{
            background-color: #264eff;
            color:#fff;
        }
        table tbody th {
            text-align: left;
            font-size: .8em;
        }
        .txt{
            text-align: left;
            font-size: .75em;
            width: 45%;
            font-weight: bold;
        }
        .input_num{
            width: 20%;
        }
        .unit{
            text-align: right;
            width: 12%;
        }
        .slider_bar{
            width: 23%;
        }
        @media screen and (max-width: 600px) {
            table{width: 100%;}
        }
    </style>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {packages: ['corechart', 'line']});

        var config = {
            externalVoltage:  40e+2,
            vacancyEnergy:    3.956e+5,
            oxygenPressure:   0.21,
            heatCapacity:     56.188,
            molarVolume:      2.02e-5,
            electronDOS:      7.0e+20,
            formationEntropy: 8.3145,
            mobilityCoef:     8.02e-02,
            rearrangeE:       1.824e+5,
            localValency:     -2,
            localPotential:   3.75,
            heatingRate:      0.167,
            semiBandGap:      4.824e+5 ,
            semiEDOS:         1.31e+28,
            semiElectron: {
                localVoltage: {
                    enable: false,
                },
            },
            title: "Furnace temperature dependence of power dissipation in flash sintering.",
            hAxis: {
                title: "Temperature /℃",
                window: {
                    max: 1500,
                    min: 500,
                }
            },
            vAxis: {
                title: "Power dissipation /10^9Wm^-3",
                window: {
                    max: 1.0,
                    min: 0,
                }
            },
            color: "#d80000",
        };

        function send () {
            var params = {
                "external_voltage": config.externalVoltage,
                "vacancy_energy": config.vacancyEnergy,
                "oxygen_pressure": config.oxygenPressure,
                "heat_capacity": config.heatCapacity,
                "molar_volume": config.molarVolume,
                "electron_DOS": config.electronDOS,
                "formation_entropy": config.formationEntropy,
                "mobility_coef": config.mobilityCoef,
                "rearrange_energy": config.rearrangeE,
                "local_valency": config.localValency,
                "local_potential": config.localPotential,
                "heating_rate": config.heatingRate,
                "semi_band_gap": config.semiBandGap,
                "semi_EDOS": config.semiEDOS,
                "enable_voltage": config.semiElectron.localVoltage.enable
            };
            $.get("/calc/flash/", params).done(function (data) {
                var dataTable = new google.visualization.DataTable();
                dataTable.addColumn('number', 'X');
                dataTable.addColumn('number', 'W');

                var googleChartData = [];
                for (i = 0; i < data["temperature"].values.length; i++){
                    var temp = data["temperature"].values[i];
                    var power = data["power_dissipation"].values[i]/1.0e+9;
                    var datas = [temp, power];
                    googleChartData.push(datas)
                }
                dataTable.addRows(googleChartData);

                var options = {
                    legend: {
                        position: "none"
                    },
                    title: config.title,
                    titleTextStyle: {
                        fontSize: 20
                    },
                    hAxis: {
                        title: config.hAxis.title,
                        viewWindow: {
                            max: config.hAxis.window.max,
                            min: config.hAxis.window.min,
                        },
                        titleTextStyle: {
                            italic: false,
                            bold: true,
                        }
                    },
                    vAxis: {
                        title: config.vAxis.title,
                        viewWindow: {
                            max: config.vAxis.window.max,
                            min: config.vAxis.window.min,
                        },
                        titleTextStyle: {
                            italic: false,
                            bold: true,
                        }
                    },
                    colors: [config.color],
                };
                var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
                chart.draw(dataTable, options);
            })
        }

        window.onload = function () {
            send();
            $('#input_ev_txt, #input_ev_sld').change(function () { send_ev(this.value); });
            $('#input_ve_txt, #input_ve_sld').change(function () { send_ve(this.value); });
            $('#input_pO2_txt, #input_pO2_sld').change(function () { send_pO2(this.value); });
            $('#input_cp_txt, #input_cp_sld').change(function () { send_cp(this.value); });
            $('#input_mv_txt, #input_mv_sld').change(function () { send_mv(this.value); });
            $('#input_eDOS_txt, #input_eDOS_sld').change(function () { send_eDOS(this.value); });
            $('#input_fe_txt, #input_fe_sld').change(function () { send_fe(this.value); });
            $('#input_mc_txt, #input_mc_sld').change(function () { send_mc(this.value); });
            $('#input_re_txt, #input_re_sld').change(function () { send_re(this.value); });
            $('#input_lv_txt, #input_lv_sld').change(function () { send_lv(this.value); });
            $('#input_lp_txt, #input_lp_sld').change(function () { send_lp(this.value); });
            $('#input_hr_txt, #input_hr_sld').change(function () { send_hr(this.value); });
            $('#input_ebg_txt, #input_ebg_sld').change(function () { send_ebg(this.value); });
            $('#input_neds_txt, #input_neds_sld').change(function () { send_neds(this.value); });

            $('#localVoltage').change(function() {
                config.semiElectron.localVoltage.enable = this.checked === true;
                send();
            });
        };

        window.onresize = function () {
            send()
        };

        function send_ev(num) {
            config.externalVoltage = num;
            document.getElementById('input_ev_sld').value = num;
            send();
        }
        function send_ve(num) {
            config.vacancyEnergy = num;
            document.getElementById('input_ve_sld').value = num;
            send();
        }
        function send_pO2(num) {
            config.oxygenPressure = num;
            document.getElementById('input_pO2_sld').value = num;
            send();
        }
        function send_cp(num) {
            config.heatCapacity = num;
            document.getElementById('input_cp_sld').value = num;
            send();
        }
        function send_mv(num) {
            config.molarVolume = num;
            document.getElementById('input_mv_sld').value = num;
            send();
        }
        function send_eDOS(num) {
            config.electronDOS = num;
            document.getElementById('input_eDOS_sld').value = num;
            send();
        }
        function send_fe(num) {
            config.formationEntropy = num;
            document.getElementById('input_fe_sld').value = num;
            send();
        }
        function send_mc(num) {
            config.mobilityCoef = num;
            document.getElementById('input_mc_sld').value = num;
            send();
        }
        function send_re(num) {
            config.rearrangeE = num;
            document.getElementById('input_re_sld').value = num;
            send();
        }
        function send_lv(num) {
            config.localValency = num;
            document.getElementById('input_lv_sld').value = num;
            send();
        }
        function send_lp(num) {
            config.localPotential = num;
            document.getElementById('input_lp_sld').value = num;
            send();
        }
        function send_hr(num) {
            config.heatingRate = num;
            document.getElementById('input_hr_sld').value = num;
            send();
        }
        function send_ebg(num) {
            config.semiBandGap = num;
            document.getElementById('input_ebg_sld').value = num;
            send();
        }
        function send_neds(num) {
            config.semiEDOS = num;
            document.getElementById('input_neds_sld').value = num;
            send();
        }
        function changing_ev(num) {
            document.getElementById('input_ev_txt').value = num;
        }
        function changing_ve(num) {
            document.getElementById('input_ve_txt').value = num;
        }
        function changing_pO2(num) {
            document.getElementById('input_pO2_txt').value = num;
        }
        function changing_cp(num) {
            document.getElementById('input_cp_txt').value = num;
        }
        function changing_mv(num) {
            document.getElementById('input_mv_txt').value = num;
        }
        function changing_eDOS(num) {
            document.getElementById('input_eDOS_txt').value = num;
        }
        function changing_fe(num) {
            document.getElementById('input_fe_txt').value = num;
        }
        function changing_mc(num) {
            document.getElementById('input_mc_txt').value = num;
        }
        function changing_re(num) {
            document.getElementById('input_re_txt').value = num;
        }
        function changing_lv(num) {
            document.getElementById('input_lv_txt').value = num;
        }
        function changing_lp(num) {
            document.getElementById('input_lp_txt').value = num;
        }
        function changing_hr(num) {
            document.getElementById('input_hr_txt').value = num;
        }
        function changing_ebg(num) {
            document.getElementById('input_ebg_txt').value = num;
        }
        function changing_neds(num) {
            document.getElementById('input_neds_txt').value = num;
        }
    </script>
</head>
<body>

<div id="chart_div" style="width: 100%; height: 800px; margin: auto"></div>

<table>
    <thead>
    <tr>
        <th colspan="4">プロセスパラメータ</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <th class="txt">外部電圧</th>
        <td class="input_num"><input id="input_ev_txt" type="text" value="40e+2" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm V}/{\rm m}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_ev_sld" type="range" value="40e+2" min="0" max="20000" step="100" oninput="changing_ev(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">昇温速度</th>
        <td class="input_num"><input id="input_hr_txt" type="text" value="0.167" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm K}/{\rm s}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_hr_sld" type="range" value="0.167" min="0" max="1" step="0.001" oninput="changing_hr(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">局所価数</th>
        <td class="input_num"><input id="input_lv_txt" type="text" value="-2" class="input_txt"></td>
        <td class="unit"></td>
        <td class="slider_bar"><input id="input_lv_sld" type="range" value="-2" min="-3" max="-1" step="0.1" oninput="changing_lv(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">局所電位</th>
        <td class="input_num"><input id="input_lp_txt" type="text" value="3.75" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm V}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_lp_sld" type="range" value="3.75" min="0" max="5" step="0.01" oninput="changing_lp(this.value)"></td>
    </tr>
    </tbody>
</table><br>

<table>
    <thead>
    <tr>
        <th colspan="4">物質パラメータ</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <th class="txt">酸素分圧</th>
        <td class="input_num"><input id="input_pO2_txt" type="text" value="0.21" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm bar}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_pO2_sld" type="range" value="0.21" min="0" max="0.3" step="0.00001" oninput="changing_pO2(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">定圧モル熱容量</th>
        <td class="input_num"><input id="input_cp_txt" type="text" value="56.188" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm J}/{\rm K\cdot mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_cp_sld" type="range" value="56.188" min="0" max="100" step="0.001" oninput="changing_cp(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">モル体積</th>
        <td class="input_num"><input id="input_mv_txt" type="text" value="2.02e-5" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm m^3}/{\rm mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_mv_sld" type="range" value="2.02e-5" min="1e-5" max="3e-5" step="1e-6" oninput="changing_mv(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">酸素イオン空孔の形成エンタルピー</th>
        <td class="input_num"><input id="input_ve_txt" type="text" value="3.956e+5" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm J}/{\rm mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_ve_sld" type="range" value="3.956e+5" min="2e+5" max="6e+5" step="1e+3" oninput="changing_ve(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">酸素イオン空孔の形成エントロピー</th>
        <td class="input_num"><input id="input_fe_txt" type="text" value="8.3145" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm J}/{\rm K\cdot mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_fe_sld" type="range" value="8.3145" min="0" max="20" step="0.0001" oninput="changing_fe(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">電子のホッピング伝導における頻度因子</th>
        <td class="input_num"><input id="input_mc_txt" type="text" value="8.02e-02" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm m^2}/{\rm Vs}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_mc_sld" type="range" value="8.02e-02" min="1e-2" max="20e-2" step="1e-3" oninput="changing_mc(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">電子のホッピング伝導における活性化エネルギー</th>
        <td class="input_num"><input id="input_re_txt" type="text" value="1.824e+5" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm J}/{\rm mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_re_sld" type="range" value="1.824e+5" min="1e+5" max="3e+5" step="1e+4" oninput="changing_re(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">単位体積当たりの電子の有効状態密度</th>
        <td class="input_num"><input id="input_eDOS_txt" type="text" value="7.0e+20" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm m^{-3}}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_eDOS_sld" type="range" value="7.0e+20" min="1e+20" max="20e+20" step="1e+19" oninput="changing_eDOS(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">真性半導体におけるバンドギャップ</th>
        <td class="input_num"><input id="input_ebg_txt" type="text" value="4.824e+5" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm J}/{\rm mol}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_ebg_sld" type="range" value="4.824e+5" min="1e+5" max="1e+6" step="1e+4" oninput="changing_ebg(this.value)"></td>
    </tr>
    <tr>
        <th class="txt">真性半導体における電子の状態密度</th>
        <td class="input_num"><input id="input_neds_txt" type="text" value="1.31e+28" class="input_txt"></td>
        <td class="unit"><img src="https://chart.googleapis.com/chart?cht=tx&chl=[{\rm m^{-3}}]&chs=500" height="12px"></td>
        <td class="slider_bar"><input id="input_neds_sld" type="range" value="1.31e+28" min="0" max="1e+29" step="1e+24" oninput="changing_neds(this.value)"></td>
    </tr>
    <tr>
        <th colspan="4" style="text-align: center">
            <input id="localVoltage" type="checkbox"> 真性半導体に起因する電子数に局所的な電場エネルギーを考慮する
        </th>
    </tr>
    </tbody>
</table>

<br><br>

</body>
</html>
